# Объекты

Фон полезен в тех ситуациях, когда весь экран перемещается одновременно, однако не везде это может быть использовано.
Например, курсор в меню, NPC, игрок, пули, шарики - все это должно перемещаться на экране независимо от фона.
К счастью, у Game boy есть решение этой проблемы.
В этом уроке объясним, что такое *объекты*("objects" или "OBJ")

::: tip

По описанию выше, вы, наверное, могли подумать, что речь идет о "спрайтах".
У "спрайта" существует очень много определений в зависимости от контекста, поэтому, чтобы избежать недопонимания, здесь используются термины такие как: *объект*, *метаспрайт*, *актер* и т.д.

:::

Каждый объект позволяет выводить 1-2 тайла (8x8 или 8x16 пикселей) в любом месте на экране, внезависимости от фона, который выводится в сетку.
Объект состоит из позиции на экране, ID тайла(как в [тайл в тайлмапе](../part1/tilemap.md)) и дополнительных параметров - "атрибутов".
Эти дополнительные параметры позволяют, например, отобразить объект перевернутым.
Мы увидим их в действии позже.

Как и тайлы хранятся в VRAM, так и объекты хранятся в месте, названном OAM(**Object Attribute Memory**).
Повторим, что объекты состоят из:
- Позиции на экране
- ID тайла
- Атрибутов

Они хранятся в 4 байтах: 1 для Y координаты, 1 для X координаты, 1 для ID тайла и 1 для атрибутов.
OAM - это 160 байтовый раздел в памяти,  160 / 4 = 40, Game boy разрешает нам добавить **40** объектов.

Однако, есть нюанс: координаты объекта на самом деле не хранят его позицию на экране.
На самом деле позиция *на экране* по X равняется X объекта **минус 8**; позиция *на экране* по Y равняется Y объекта **минус 16**.
Чтобы прекратить отображение объекта, мы можем просто его убрать с экрана, т.е. просто изменить Y позицию на 0.

::: tip

Такие смещения на самом деле не произвольны!
Учитывайте, что максимальный размер объекта - 8 на 16 пикселей.
Эти смещения позволяют объектам заходить за левый и верхний края экрана.
NES, например, не дает такой возможности, поэтому вы можете заметить, как объекты исчезают после прикосновения к левому или верхнему краю.

:::

Давайте поэкспериментируем с объектами!

Во-первых, когда Game boy запускается, OAM заполяется псевдо-случайными числами, которые могут заполнить экран артефактами.
Давайте почистим OAM перед тем, как будем работать с объектами.
Давайте добавим следующий код сразу после цикла `CopyTilemap`:

```rgbasm
{{#include ../../unbricked/objects/main.asm:clear-oam}}
```

Сейчас хорошее время сделать это, т.к. как и в случае с VRAM, экран должен быть выключен, чтобы безопасно взаимодействовать с OAM.

Когда OAM очищен, мы можем отображать объекты, изменяя его параметры.

```rgbasm,linenos,start={{#line_no_of "" ../../unbricked/objects/main.asm:init-object}}
{{#include ../../unbricked/objects/main.asm:init-object}}
```

Помните, что каждый объект OAM состоит из 4 байтов, в порядке: Y, X, ID тайла, атрибуты.
Поэтому, верхний угол объекта находится на расстоянии в 128 пискелей от верхнего и в 16 от левого края экрана.
ID тайла и атрибут установлены на 0.

Вы можете вспомнить, что в прошлом уроке мы уже использовали 0 в ID тайлов: с него начиналась отрисовка фона.
Однако, по умолчанию объекты и фон используют разные наборы тайлов, по крайней мере для первых 128 ID.
Тайлы c ID 128-255 используются и там и там, 