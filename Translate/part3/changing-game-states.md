# Смена состояния игры

Давайте определим метку "NextGameState" в файле GalacticArmada.asm. В нашей игре будет 3 состояния:

- Главный экран
- Экран с лором
- Игровой экран

Вот как они будут сменяться:

![Game States Visualized.png](../assets/part3/img/Game_States_Visualized.png)

Когда одному игровому состоянию нужно переключиться на другое, ему будет необходимо переопределить переменную 'wGameState' и прыгнуть на метку "NextGameState". Есть перечень задач, который нам надо выполнить, чтобы сменить игровое состояние.

(во время VBlank)

- Выключить LCD
- Восстановить расположение окна и фона по умолчанию
- Очистить фон
- Запретить прерывания
- Удалить все спрайты
- Инициализировать *следующее* игровое состояние.
- Выполнить переход к коду *следующего* игрового состояния.

> Именно функции инициализации каждого игрового состояния отвечают за включение экрана Game Boy.

```rgbasm,linenos,start={{#line_no_of "" ../../galactic-armada/src/main/GalacticArmada.asm:next-game-state}}
{{#include ../../galactic-armada/src/main/GalacticArmada.asm:next-game-state}}
```

Ключевая задача этой части кода - убрать как можно больше сторонних факторов, которые могут мешать переключению состояния.

На этом мы заканчиваем разбор файла GalacticArmada.asm.
